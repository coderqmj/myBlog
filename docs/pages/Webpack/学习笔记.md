## 二、webpack配置文件

### 1.打包过程

**指定入口出口打包方式一：命令**

`webpack --ebtry ./src/main.js --output-path ./build`

**指定出口入口方式二：配置文件（重点）**

```js
// webpack.config.js
const path = require('path');
module.exports = {
  entry: './src/main.js',
  output: {
    filename: "boundle.js",
    // 必须是绝对路径
    path: path.resolve(__dirname, "./build")
  }
}
```

**假如文件名不是webpack.config.js**

- 那就没有办法打包成功了，怎么办？
- 因为执行`webpack`命令时，会去查找`webpack.config.js`这个文件执行 
- 解决：
  - 在配置文件里面修改build指令的配置参数

![](./images/webpack_01.png)

### 2.webpack依赖关系图

- webpack到底是如何对我们的项目进行打包的呢？
  - 事实上webpack处理应用程序时，根据命令或已配置的文件找到入口
  - 入口开始，生成一个 **依赖关系图**，这个依赖关系图会包含应用程序中所需的所有模块（js，css，图片，字体）
  - 遍历图结构，打包一个个模块（根据文件的不同使用不同的loader来解析）
- 上述的例子：
  - 例子一：安装了某个第三方库`axios`，但是并没有使用，所以打包不会带进去，打包后总体积不会增大。
  - 例子二：项目中创建的文件，没有被引用，最后打包不会在依赖图上，所以体积也不会增大。
  - 例子三：假如有个js文件里面有函数，js确实被引用了，但是函数未被执行，函数也不会被打包。
    - 涉及到tree shaking 

###  3.代码编写案例

- 写了个css，导入到文件，最后把它打包，最后会报错，原因是缺少加载css的loader

- loader是什么呢？

  - 用于对模块的源代码进行替换
  - css文件也可以看成是一个模块，通过 **import**来加载这个模块
  - 在加载这个模块时，webpack其实并不知道如何对其进行加载，我们必须制定对应的loader来完成这个功能

- 那么什么样的loader可以加载css呢？

  - 这个常用的loader最常用的是css-loader
  - 安装：`npm install css-loader -D`

- css-loader的三种使用方案：

  - 内联 

  <img src="./images/css_loader.png" alt="css-loader" style="zoom:50%;" />

  - CLI方式（webpack5中不再使用）
  - 配置方式 

  

- 有`css-loader`表示正常处理解析了css文件，但是解析之后的css文件没有插入到页面上。

- 想要插入style，就需要使用`style-loader`

  - `npm i style-loader -D `
  - use: ["style-loader"]
  - style-loader的原理就是在document.createElement(style)创建了个样式表

- 注意：webpack处理loader的时候是从下往上的，从右往左的



### 4.loader配置方式

- module.rules的配置如下：
- rules属性对应的值是一个数组 **[Rule]**
- 数组中存放的时 一个个的Rule，Rule是一个对象，对象中可以设置多个属性：
  - test属性：用于对resource（资源）进行匹配，通常设置成正则表达式
  - use属性：对应的值是一个数组：**[UseEntry]**，也是一个对象，有两个key
    - loader：指明要用哪些loader
    - options：可选属性，值可以使字符串或对象，值会被传入到loader中
  - `use:["css-loader"]`相当于键值对的写法

<img src="./images/rules.png" alt="rules" style="zoom:50%;" />

### 5.如何处理less文件？

#### 5.1安装相关工具

- 肯定是要把less转换成css的，需要安装less工具 `npm i less -D`

- 然后 `npx less ./src/css/component.less > component.css`即可转换成正常css文件

- 但是在正常开发中需要同时安装 **less** 和 **less-loader**  `npm i less less-loader -D`

  

#### 5.2配置相关rule（less）

<img src="./images/less.png" alt="less" style="zoom:50%;" />

#### 5.3 postcss-loader